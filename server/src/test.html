<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>Socket test</title>
	</head>
	<body>
		Hey
		<script src="/socket.io/socket.io.js"></script>
		<script>
			const socketIO = io.connect('http://localhost:8080');
			let room;

			async function newRoom(id = 0) {
				const fakeData = { mode: 'test', roomId: `aasdsa${id}`, hasPwd: true, pwd: 'secret', roomName: 'test room2', maxPlayers: 3 };
				await socketIO.emit('newRoom', fakeData, (callback) => {
					console.log(callback);
				});
				room = fakeData.roomId;
			};

			async function getRoomList() {
				await socketIO.emit('getRoomList');
				socketIO.on('getRoomList', (data) => console.log(data));
			};

			async function startGame(id = 0) {
				await socketIO.emit('startGame', { id }, (callback) => {
					console.log(callback);
				});
			};

			async function getNextPiece(id = room) {
				await socketIO.emit('getNextPiece', { roomId: id }, (callback) => {
					console.log('Receiving next piece: ');
					console.log(callback);
				});
			}

			async function joinRoom(id, pwd = 'secret') {
				await socketIO.emit('joinRoom', { roomId: id, pwd: pwd }, (callback) => console.log(callback));
			}

			async function getRoomInfo(id = room) {
				await socketIO.emit('getRoomInfo', { roomId: id }, (callback) => console.log(callback));
			}

			async function scorePoint(id = room, row = 1) {
				await socketIO.emit('playerIsScoring', { roomId: id, numberOfRows: row }, callback => console.log(callback));
			}

			socketIO.on('gameHasStarted', (data) => {
				console.log('Game begins on lobby: ');
				console.log(data);
			});
		</script>
	</body>
</html>
